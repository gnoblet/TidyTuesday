{
  "hash": "2ec6fe6536959f0dcefda44d13f27a31",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"English Monarchs Marriages\"\nsubtitle: \"TidyTuesday Week 34\"\ndate: \"2024-08-20\"\nauthor: \"gnoblet\"\ncategories: [r, ggplot2, tidyverse, history]\nexecute:\n  freeze: true  \n---\n\n## Overview\n\nThis week's TidyTuesday explored marriage data of English monarchs, analyzing age differences between kings and their consorts over time. The visualization reveals fascinating patterns in royal marriage dynamics from medieval times to the modern era.\n\n## Dataset\n\nThe dataset contains marriage information for English monarchs including:\n- King and consort ages at marriage\n- Year of marriage\n- Names of monarchs and consorts\n\n**Source**: [TidyTuesday English Monarchs Marriages](https://github.com/rfordatascience/tidytuesday/tree/master/data/2024/2024-08-20)\n\n## Analysis\n\n### Data Preparation\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get data\ndf <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-08-20/english_monarchs_marriages_df.csv')\n\n# Convert variables to numeric\ndf <- dyr$mutate(\n  df,\n  dyr$across(\n    c(king_age, consort_age, year_of_marriage),\n    as.numeric\n  )\n)\n\n# Calculate age difference (positive = king older, negative = consort older)\ndf <- dyr$mutate(df, age_diff = king_age - consort_age)\n\n# Basic statistics\nolder_consorts <- dyr$filter(df, age_diff < 0) |> nrow()\ntotal_marriages <- nrow(df)\n```\n:::\n\n\n### Key Statistics\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get extremes\nmax_diff <- max(df$age_diff, na.rm = TRUE)\nmin_diff <- min(df$age_diff, na.rm = TRUE)\nmax_year <- max(df$year_of_marriage, na.rm = TRUE)\nmin_year <- min(df$year_of_marriage, na.rm = TRUE)\n\n# Find specific cases\nmax_case <- df[which.max(df$age_diff), ]\nmin_case <- df[which.min(df$age_diff), ]\n\ncat(\"Marriage Analysis Summary:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMarriage Analysis Summary:\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- Total marriages analyzed:\", total_marriages, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- Total marriages analyzed: 83 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- Marriages where consort was older:\", older_consorts, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- Marriages where consort was older: 8 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- Time period:\", min_year, \"to\", max_year, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- Time period: 856 to 1947 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- Largest age gap (king older):\", max_diff, \"years\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- Largest age gap (king older): 40 years\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"- Largest age gap (consort older):\", abs(min_diff), \"years\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- Largest age gap (consort older): 12 years\n```\n\n\n:::\n:::\n\n\n### Visualization\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng <- gg$ggplot(df) + \n  gg$geom_point(\n    gg$aes(\n      x = year_of_marriage,\n      y = age_diff,\n      color = age_diff, \n      size = abs(age_diff)\n    )\n  ) +\n  gg$scale_size_area(max_size = 10) +\n  gg$scale_color_gradientn(\n    colors = c(\"#3d5941\", \"#f6edbd\", \"#ca562c\"),\n    values = scales::rescale(c(-12, 0, 40)),\n    limits = c(-12, 40)\n  ) +\n  # Annotation for maximum age difference\n  gg$annotate(\n    geom = \"text\",\n    x = max_case$year_of_marriage + 320,\n    y = max_diff - 3,\n    label = sgr$str_wrap(paste0(max_case$king_name, \" was \", abs(max_diff), \n                               \" years older than consort \", max_case$consort_name, \". \"), 35),\n    color = \"#ca562c\",\n    size = 4.5,\n    hjust = 0.5\n  ) +\n  gg$annotate(\n    geom = \"curve\",\n    x = max_case$year_of_marriage + 150,\n    y = max_diff - 3,\n    xend = max_case$year_of_marriage + 25,\n    yend = max_diff - 0.5,\n    color = \"#ca562c\",\n    arrow = gg$arrow(length = gg$unit(0.01, \"npc\")), \n    curvature = -0.1\n  ) +\n  # Annotation for minimum age difference  \n  gg$annotate(\n    geom = \"text\",\n    x = min_case$year_of_marriage - 250,\n    y = min_diff - 3,\n    label = sgr$str_wrap(paste0(min_case$king_name, \" was \", abs(min_diff), \n                               \" years younger than consort \", min_case$consort_name), 30),\n    color = \"#3d5941\",\n    size = 4.5,\n    hjust = 0.5\n  ) +\n  gg$annotate(\n    geom = \"curve\",\n    x = min_case$year_of_marriage - 100,\n    y = min_diff - 3,\n    xend = min_case$year_of_marriage - 10,\n    yend = min_diff - 1,\n    color = \"#3d5941\",\n    curvature = 0.3,\n    arrow = gg$arrow(length = gg$unit(0.01, \"npc\"))\n  ) +\n  gg$guides(size = \"none\") +\n  gg$labs(\n    x = \"Year of Marriage\",\n    y = \"Age Difference (Years)\",\n    title = \"Marriage Age Differences between English Monarchs and Consorts\",\n    subtitle = sgr$str_wrap(paste0(\"From \", min_year, \" to \", max_year, \n                                  \", Consorts were \", \"<b><span style='color:#3d5941'>older</span></b>\", \n                                  \" than Monarchs for \", \"<b><span style='color:#3d5941'>\", \n                                  older_consorts, \" marriages</span></b> only.\"), 75),\n    caption = \"Data: TidyTuesday 2024-08-20\"\n  ) + \n  gghrbr$theme_ipsum_rc(base_size = 14) +\n  gg$scale_y_continuous(breaks = seq(-20, 40, 10), limits = c(-20, 45)) +\n  gg$theme_minimal() +\n  gg$theme(\n    plot.background = gg$element_rect(fill = 'white', color = NA), \n    legend.title = gg$element_blank(),\n    axis.title.y = gg$element_blank(),\n    axis.title.x = gg$element_blank(),\n    axis.text = gg$element_text(size = 13),\n    plot.title = ggt$element_textbox_simple(size = 24, margin = gg$margin(b = 20, t = 10)),\n    plot.subtitle = ggt$element_textbox_simple(size = 18)\n  )\n```\n:::\n\n\n## Save\n\n::: {.cell}\n\n```{.r .cell-code}\ngg$ggsave('week_34.png', g, width = 12, height = 8)\n```\n:::\n\n\n## Technical Notes\n\n- Used diverging color scale to highlight positive vs negative age differences\n- Point size represents magnitude of age difference\n- Annotations highlight the most extreme cases\n- Data spans from 856 to 1947\n\n## Viz\n\n![](week_34.png)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}